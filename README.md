# mpv-music
An MPV wrapper for music playback, with fzf integration and configurable options.

---

## Table of Contents

* [Features](#features)
* [Installation](#installation)
* [Usage](#usage)
* [Configuration](#configuration)
* [Dependencies](#dependencies)
* [License](#license)

---

## Features

* **Direct File/URL Playback:** Play specific local audio/video files or stream directly from URLs(e.g., YouTube) by passing them as arguments.
* **Interactive Music Selection:** Use `fzf` to fuzzy-find and select music.
* **Two Playback Modes:**
  * **Album Mode:** Select entire folders/albums to play.
  * **Track Mode:** Pick individual music files.
* **User-Friendly Configuration:** All core settings are externalized to a simple `mpv-music.conf` file, allowing easy customization without editing the script.
* **Customizable MPV Arguments:** Pass any `mpv` flags directly via command line or set default flags in the configuration.
* **Flexible Music Directories:** Define one or more music root directories in the config file, or specify a custom path on the fly.
* **Extensible File Type Support:** Easily add or remove supported audio and video file extensions via the configuration.
* **Video Playback Toggle:** Option to include video files in your selection. By default, `mpv` plays even video files in audio-only mode unless overridden by `mpv` flags.

---

## Installation

1. **Clone the Repository:**
    ```bash
    git clone https://github.com/FurqanHun/mpv-music.git
    cd mpv-music
    ```

2. **Make Executable:**
    ```bash
    chmod +x mpv-music
    ```

3. **Place in your PATH:**
    Move the `mpv-music` script to a directory included in your system's `PATH` (e.g., `/usr/local/bin/`, `~/.local/bin/`, or `~/bin/`).
    ```bash
    mv mpv-music /usr/local/bin/ # Or ~/.local/bin/ or ~/bin/
    ```

4. **First Run (Config Generation):**
    The first time you run `mpv-music`, it will automatically create a default configuration file at `~/.config/mpv-music/mpv-music.conf`.
    ```bash
    mpv-music
    ```
    You'll see a message like:
    `Created default config file at ~/.config/mpv-music/mpv-music.conf`

---

## Usage

Run the script from your terminal:

```bash
mpv-music [PATH_OR_URL_OR_MUSIC_DIR] [OPTIONS]
```

* **No arguments:** Uses music directories defined in `~/.config/mpv-music/mpv-music.conf` and default `mpv` flags.
* **`[PATH_OR_URL_OR_MUSIC_DIR]`:**
  * **Direct Playback:** Provide a direct path to a local file (e.g., ~/Music/song.mp3) or a URL (e.g., https://maybeaurl/file) to play immediately. This bypasses interactive selection.

  * **Custom Music Directory:** Provide a path to an existing directory (e.g., /path/to/my/tunes). This will override the MUSIC_DIRS from your config for the current run, but will not bypass interactive selection.
* **`[OPTIONS]`:** Pass any `mpv` flags (e.g., `--volume=50 --no-video`) or script-specific options.

**Examples:**

```bash
mpv-music                                   # Uses directories from config with default mpv flags
mpv-music /path/to/music                    # Uses custom folder with default mpv flags
mpv-music ~/Music/my_favorite_song.flac     # Plays a specific local FLAC file directly
mpv-music https://maybeaurl/file            # Plays a file from URL video/audio directly
mpv-music --no-video --volume=20            # Uses config directories with custom flags
mpv-music /path/to/music --no-video         # Custom folder + custom flags

# Script-specific options:
mpv-music --video-ok                        # Includes video file formats (from config)
mpv-music --ext=mp3,ogg                     # Uses only mp3 and ogg extensions
```

---

## Configuration

The `mpv-music` script uses a configuration file located at `~/.config/mpv-music/mpv-music.conf`. This file is automatically generated with sensible defaults on the first run.

You can edit this file to customize:

* **`MUSIC_DIRS`**: Space-separated paths to your music collections.
* **`MPV_DEFAULT_ARGS`**: Space-separated default arguments to pass to `mpv`.
* **`AUDIO_EXTS`**: Space-separated list of file extensions considered audio.
* **`VIDEO_EXTS`**: Space-separated list of file extensions considered video.

**Example `mpv-music.conf` content:**

```bash
# mpv-music configuration file

# Default music directories (space-separated)
# You can add multiple paths, e.g., MUSIC_DIRS="$HOME/Music /mnt/my_music_drive/audio"
MUSIC_DIRS="/home/qan/Music"

# Default MPV arguments (space-separated)
# These will be used if no other MPV args are passed on the command line.
# Example: MPV_DEFAULT_ARGS="--loop-playlist=inf --shuffle --no-video --volume=50"
MPV_DEFAULT_ARGS="--loop-playlist=inf --shuffle --no-video"

# Audio extensions (space-separated)
# These are used when --video-ok is NOT specified.
AUDIO_EXTS="mp3 flac wav m4a aac ogg opus wma alac aiff amr"

# Video extensions (space-separated)
# These are added to AUDIO_EXTS when --video-ok IS specified.
VIDEO_EXTS="mp4 mkv webm avi mov flv wmv mpeg mpg 3gp ts vob m4v"
```

---

## Dependencies

`mpv-music` requires the following tools to be installed on your system:

* **`mpv`**: A free, open source, and cross-platform media player.
  ðŸ‘‰ [https://mpv.io](https://mpv.io)
* **`fzf`**: A general-purpose command-line fuzzy finder.
  ðŸ‘‰ [https://github.com/junegunn/fzf](https://github.com/junegunn/fzf)
* **`yt-dlp`**: A youtube-dl fork for downloading videos from YouTube and other sites. Required for URL playback.
  ðŸ‘‰ [https://github.com/yt-dlp/yt-dlp](https://github.com/yt-dlp/yt-dlp)
* **GNU `find`**: Your system's `find` utility must be the GNU version (e.g., from `findutils`). A check is performed at startup.

---

## License

This project is licensed under the **MIT License**. See the [LICENSE](LICENSE) file for details.

---
